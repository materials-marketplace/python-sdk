from marketplace.datasink_client.session import MPSession

marketplace_url = "https://materials-marketplace.eu/"
access_token = "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJHUzMzZGxWQ2hXd2tGVExUS2xrU2VzcGxjUHRCdDlHV3VxM0tHWnduZG5rIn0.eyJleHAiOjE2OTM1ODkzNzYsImlhdCI6MTY5MzU2MDU3NiwiYXV0aF90aW1lIjoxNjkzNTYwNTc1LCJqdGkiOiI4ZjdkZjAxNy04YWQ1LTQ5MzAtOWFhNS1mOTI2YmUzYmNiMWUiLCJpc3MiOiJodHRwczovL21hdGVyaWFscy1tYXJrZXRwbGFjZS5ldS9hdXRoL3JlYWxtcy9tYXJrZXRwbGFjZSIsImF1ZCI6WyJyZWFsbS1tYW5hZ2VtZW50IiwiYWNjb3VudCIsImFjY2Vzcy1jb250cm9sIl0sInN1YiI6ImZkODllMzdlLWE3NzMtNDBhNC05YTU3LTgyMDQxZGU2YTExZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImZyb250ZW5kIiwibm9uY2UiOiIzYmMyN2FhZi02NDQwLTQ5YjAtODRkZS0xMjM0MzU3MGM2OGIiLCJzZXNzaW9uX3N0YXRlIjoiN2U2MWQzOTYtOGE5NC00OWRmLWJkMTMtNTlhYThiMmRhOTExIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwczovL21hdGVyaWFscy1tYXJrZXRwbGFjZS5ldSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsiZGVmYXVsdC1yb2xlcy1tYXJrZXRwbGFjZSIsIm9mZmxpbmVfYWNjZXNzIiwiYXBwLWFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iLCJhcHAtdXNlciJdfSwicmVzb3VyY2VfYWNjZXNzIjp7InJlYWxtLW1hbmFnZW1lbnQiOnsicm9sZXMiOlsibWFuYWdlLWlkZW50aXR5LXByb3ZpZGVycyIsIm1hbmFnZS11c2VycyIsIm1hbmFnZS1jbGllbnRzIl19LCJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX0sImZyb250ZW5kIjp7InJvbGVzIjpbImFkbWluIiwidXNlciJdfSwiYWNjZXNzLWNvbnRyb2wiOnsicm9sZXMiOlsiYWRtaW4iLCJ1c2VyIl19fSwic2NvcGUiOiJvcGVuaWQgY2xpZW50X3JvbGVzX2Zyb250ZW5kIHByb2ZpbGUgZW1haWwiLCJzaWQiOiI3ZTYxZDM5Ni04YTk0LTQ5ZGYtYmQxMy01OWFhOGIyZGE5MTEiLCJlbWFpbF92ZXJpZmllZCI6dHJ1ZSwicm9sZXMiOlsiYWRtaW4iLCJ1c2VyIl0sIm5hbWUiOiJLaXJhbiBLdW1hcmFzd2FteSIsInByZWZlcnJlZF91c2VybmFtZSI6ImtpcmFuLmt1bWFyYXN3YW15QGl3bS5mcmF1bmhvZmVyLmRlIiwiZ2l2ZW5fbmFtZSI6IktpcmFuIiwiZmFtaWx5X25hbWUiOiJLdW1hcmFzd2FteSIsImVtYWlsIjoia2lyYW4ua3VtYXJhc3dhbXlAaXdtLmZyYXVuaG9mZXIuZGUifQ.fATcyTImfCaaslKfhPaI3i5_NcTDDr_iyqK6praBaacTIARhp0CzrHlw5w9IkGv2iu3I_ByOevl-tZzEuOPCvg4W69rLsVct8AKvB7OoPXrNpIEOi8RFVk6YM3GUij4OwBsKJ0Juof79LTYbXbiinf_pw_tC9ENFLU1jGaTzLFR07qRTgSFmY0EwjEFdFkOQKCdrVrW_5UrSNTh1EITnIAIudlB6tFheA-tN-DpI4rPKlRobO30tTpX7SLdUC4TDt1_BtjAkS2twHSuOcKWvXnLcnYo_IpDYNuRSuQMfAbuPuvyh2LmuJbdCENBWhl1P_5DMbiqBWIA_-oP0SV3Yow"


client_id = "edb56699-9377-4f41-b1c7-ef2f46dac707"

query = """SELECT ?subject ?predicate ?object WHERE {{ ?subject ?predicate ?object . }} LIMIT 5"""
with MPSession(
    marketplace_host_url=marketplace_url, access_token=access_token, client_id=client_id
) as test:
    objects = test.query(query=query)
    print(objects)
